---
title: "Data Cleaning"
author: "Eli Cohen, Sarah Tandean"
date: "2023-01-28"
output: pdf_document
---

```{r setup, include=FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r}
## Data initialization

init.data = read.csv("Initial_Play_-_By_-_Play.csv")

# convert character variables to factor
factor.vars = c("ODK", "RESULT", "PLAY.TYPE")
init.data[factor.vars] = lapply(init.data[factor.vars], factor)

# renaming variables for convenience
names(init.data) = tolower(names(init.data))
names(init.data)[1] = "play"

# fixing rounding error for distance
gn.ls.lagged = lag(init.data$gn.ls)
dist.lagged = lag(init.data$dist)
#init.data$dist = dist.lagged - gn.ls.lagged

#head(init.data$dist, 20)

head(init.data)
```

```{r}
## Cleaning

# creating game ID
first.plays = which(init.data$play==1)
init.data$game = length(first.plays)
for (i in 1:(length(first.plays)-1)) {
  first = first.plays[i]
  last = first.plays[i+1]-1
  init.data$game[first:last] = i
}

# fixing yards to endzone
negative.yds = init.data$yard.ln < 0
na.yds = is.na(negative.yds)
negative.yds[na.yds] = FALSE
init.data[negative.yds, "yard.ln"] = init.data[negative.yds, "yard.ln"] + 100
names(init.data)[5] = "yds.to.endzone"

# creating drive ID
k.play.types = unique(init.data[init.data$odk == "K", ]$play.type)
num.games = max(init.data$game)
for (i in 1:num.games) {
  ind.game = init.data[init.data$game == i, ]
}
```


